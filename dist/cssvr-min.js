var THREE={REVISION:"72dev"};"object"==typeof module&&(module.exports=THREE),void 0===Math.sign&&(Math.sign=function(t){return 0>t?-1:t>0?1:+t}),THREE.Quaternion=function(t,i,s,n){this._x=t||0,this._y=i||0,this._z=s||0,this._w=void 0!==n?n:1},THREE.Quaternion.prototype={constructor:THREE.Quaternion,_x:0,_y:0,_z:0,_w:0,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get w(){return this._w},set w(t){this._w=t,this.onChangeCallback()},set:function(t,i,s,n){return this._x=t,this._y=i,this._z=s,this._w=n,this.onChangeCallback(),this},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,i){if(t instanceof THREE.Euler==!1)throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var s=Math.cos(t._x/2),n=Math.cos(t._y/2),r=Math.cos(t._z/2),e=Math.sin(t._x/2),h=Math.sin(t._y/2),o=Math.sin(t._z/2);return"XYZ"===t.order?(this._x=e*n*r+s*h*o,this._y=s*h*r-e*n*o,this._z=s*n*o+e*h*r,this._w=s*n*r-e*h*o):"YXZ"===t.order?(this._x=e*n*r+s*h*o,this._y=s*h*r-e*n*o,this._z=s*n*o-e*h*r,this._w=s*n*r+e*h*o):"ZXY"===t.order?(this._x=e*n*r-s*h*o,this._y=s*h*r+e*n*o,this._z=s*n*o+e*h*r,this._w=s*n*r-e*h*o):"ZYX"===t.order?(this._x=e*n*r-s*h*o,this._y=s*h*r+e*n*o,this._z=s*n*o-e*h*r,this._w=s*n*r+e*h*o):"YZX"===t.order?(this._x=e*n*r+s*h*o,this._y=s*h*r+e*n*o,this._z=s*n*o-e*h*r,this._w=s*n*r-e*h*o):"XZY"===t.order&&(this._x=e*n*r-s*h*o,this._y=s*h*r-e*n*o,this._z=s*n*o+e*h*r,this._w=s*n*r+e*h*o),i!==!1&&this.onChangeCallback(),this},setFromAxisAngle:function(t,i){var s=i/2,n=Math.sin(s);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(s),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var i,s=t.elements,n=s[0],r=s[4],e=s[8],h=s[1],o=s[5],a=s[9],u=s[2],c=s[6],l=s[10],y=n+o+l;return y>0?(i=.5/Math.sqrt(y+1),this._w=.25/i,this._x=(c-a)*i,this._y=(e-u)*i,this._z=(h-r)*i):n>o&&n>l?(i=2*Math.sqrt(1+n-o-l),this._w=(c-a)/i,this._x=.25*i,this._y=(r+h)/i,this._z=(e+u)/i):o>l?(i=2*Math.sqrt(1+o-n-l),this._w=(e-u)/i,this._x=(r+h)/i,this._y=.25*i,this._z=(a+c)/i):(i=2*Math.sqrt(1+l-n-o),this._w=(h-r)/i,this._x=(e+u)/i,this._y=(a+c)/i,this._z=.25*i),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,i,s=1e-6;return function(n,r){return void 0===t&&(t=new THREE.Vector3),i=n.dot(r)+1,s>i?(i=0,Math.abs(n.x)>Math.abs(n.z)?t.set(-n.y,n.x,0):t.set(0,-n.z,n.y)):t.crossVectors(n,r),this._x=t.x,this._y=t.y,this._z=t.z,this._w=i,this.normalize(),this}}(),inverse:function(){return this.conjugate().normalize(),this},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t,i){return void 0!==i?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,i)):this.multiplyQuaternions(this,t)},multiplyQuaternions:function(t,i){var s=t._x,n=t._y,r=t._z,e=t._w,h=i._x,o=i._y,a=i._z,u=i._w;return this._x=s*u+e*h+n*a-r*o,this._y=n*u+e*o+r*h-s*a,this._z=r*u+e*a+s*o-n*h,this._w=e*u-s*h-n*o-r*a,this.onChangeCallback(),this},multiplyVector3:function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},slerp:function(t,i){if(0===i)return this;if(1===i)return this.copy(t);var s=this._x,n=this._y,r=this._z,e=this._w,h=e*t._w+s*t._x+n*t._y+r*t._z;if(0>h?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,h=-h):this.copy(t),h>=1)return this._w=e,this._x=s,this._y=n,this._z=r,this;var o=Math.acos(h),a=Math.sqrt(1-h*h);if(Math.abs(a)<.001)return this._w=.5*(e+this._w),this._x=.5*(s+this._x),this._y=.5*(n+this._y),this._z=.5*(r+this._z),this;var u=Math.sin((1-i)*o)/a,c=Math.sin(i*o)/a;return this._w=e*u+this._w*c,this._x=s*u+this._x*c,this._y=n*u+this._y*c,this._z=r*u+this._z*c,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,i){return void 0===i&&(i=0),this._x=t[i],this._y=t[i+1],this._z=t[i+2],this._w=t[i+3],this.onChangeCallback(),this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){},clone:function(){return new THREE.Quaternion(this._x,this._y,this._z,this._w)}},THREE.Quaternion.slerp=function(t,i,s,n){return s.copy(t).slerp(i,n)},THREE.Vector2=function(t,i){this.x=t||0,this.y=i||0},THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(t,i){return this.x=t,this.y=i,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,i){return void 0!==i?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this},sub:function(t,i){return void 0!==i?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){if(0!==t){var i=1/t;this.x*=i,this.y*=i}else this.x=0,this.y=0;return this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this},clamp:function(t,i){return this.x<t.x?this.x=t.x:this.x>i.x&&(this.x=i.x),this.y<t.y?this.y=t.y:this.y>i.y&&(this.y=i.y),this},clampScalar:function(){var t,i;return function(s,n){return void 0===t&&(t=new THREE.Vector2,i=new THREE.Vector2),t.set(s,s),i.set(n,n),this.clamp(t,i)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var i=this.x-t.x,s=this.y-t.y;return i*i+s*s},setLength:function(t){var i=this.length();return 0!==i&&t!==i&&this.multiplyScalar(t/i),this},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this},lerpVectors:function(t,i,s){return this.subVectors(i,t).multiplyScalar(s).add(t),this},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,i){return void 0===i&&(i=0),this.x=t[i],this.y=t[i+1],this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this.x,t[i+1]=this.y,t},fromAttribute:function(t,i,s){return void 0===s&&(s=0),i=i*t.itemSize+s,this.x=t.array[i],this.y=t.array[i+1],this},clone:function(){return new THREE.Vector2(this.x,this.y)}},THREE.Vector3=function(t,i,s){this.x=t||0,this.y=i||0,this.z=s||0},THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(t,i,s){return this.x=t,this.y=i,this.z=s,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this},sub:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this},multiply:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,i)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this},applyEuler:function(){var t;return function(i){return i instanceof THREE.Euler==!1&&console.error("THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order."),void 0===t&&(t=new THREE.Quaternion),this.applyQuaternion(t.setFromEuler(i)),this}}(),applyAxisAngle:function(){var t;return function(i,s){return void 0===t&&(t=new THREE.Quaternion),this.applyQuaternion(t.setFromAxisAngle(i,s)),this}}(),applyMatrix3:function(t){var i=this.x,s=this.y,n=this.z,r=t.elements;return this.x=r[0]*i+r[3]*s+r[6]*n,this.y=r[1]*i+r[4]*s+r[7]*n,this.z=r[2]*i+r[5]*s+r[8]*n,this},applyMatrix4:function(t){var i=this.x,s=this.y,n=this.z,r=t.elements;return this.x=r[0]*i+r[4]*s+r[8]*n+r[12],this.y=r[1]*i+r[5]*s+r[9]*n+r[13],this.z=r[2]*i+r[6]*s+r[10]*n+r[14],this},applyProjection:function(t){var i=this.x,s=this.y,n=this.z,r=t.elements,e=1/(r[3]*i+r[7]*s+r[11]*n+r[15]);return this.x=(r[0]*i+r[4]*s+r[8]*n+r[12])*e,this.y=(r[1]*i+r[5]*s+r[9]*n+r[13])*e,this.z=(r[2]*i+r[6]*s+r[10]*n+r[14])*e,this},applyQuaternion:function(t){var i=this.x,s=this.y,n=this.z,r=t.x,e=t.y,h=t.z,o=t.w,a=o*i+e*n-h*s,u=o*s+h*i-r*n,c=o*n+r*s-e*i,l=-r*i-e*s-h*n;return this.x=a*o+l*-r+u*-h-c*-e,this.y=u*o+l*-e+c*-r-a*-h,this.z=c*o+l*-h+a*-e-u*-r,this},project:function(){var t;return function(i){return void 0===t&&(t=new THREE.Matrix4),t.multiplyMatrices(i.projectionMatrix,t.getInverse(i.matrixWorld)),this.applyProjection(t)}}(),unproject:function(){var t;return function(i){return void 0===t&&(t=new THREE.Matrix4),t.multiplyMatrices(i.matrixWorld,t.getInverse(i.projectionMatrix)),this.applyProjection(t)}}(),transformDirection:function(t){var i=this.x,s=this.y,n=this.z,r=t.elements;return this.x=r[0]*i+r[4]*s+r[8]*n,this.y=r[1]*i+r[5]*s+r[9]*n,this.z=r[2]*i+r[6]*s+r[10]*n,this.normalize(),this},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){if(0!==t){var i=1/t;this.x*=i,this.y*=i,this.z*=i}else this.x=0,this.y=0,this.z=0;return this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this.z>t.z&&(this.z=t.z),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this.z<t.z&&(this.z=t.z),this},clamp:function(t,i){return this.x<t.x?this.x=t.x:this.x>i.x&&(this.x=i.x),this.y<t.y?this.y=t.y:this.y>i.y&&(this.y=i.y),this.z<t.z?this.z=t.z:this.z>i.z&&(this.z=i.z),this},clampScalar:function(){var t,i;return function(s,n){return void 0===t&&(t=new THREE.Vector3,i=new THREE.Vector3),t.set(s,s,s),i.set(n,n,n),this.clamp(t,i)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){var i=this.length();return 0!==i&&t!==i&&this.multiplyScalar(t/i),this},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this},lerpVectors:function(t,i,s){return this.subVectors(i,t).multiplyScalar(s).add(t),this},cross:function(t,i){if(void 0!==i)return console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,i);var s=this.x,n=this.y,r=this.z;return this.x=n*t.z-r*t.y,this.y=r*t.x-s*t.z,this.z=s*t.y-n*t.x,this},crossVectors:function(t,i){var s=t.x,n=t.y,r=t.z,e=i.x,h=i.y,o=i.z;return this.x=n*o-r*h,this.y=r*e-s*o,this.z=s*h-n*e,this},projectOnVector:function(){var t,i;return function(s){return void 0===t&&(t=new THREE.Vector3),t.copy(s).normalize(),i=this.dot(t),this.copy(t).multiplyScalar(i)}}(),projectOnPlane:function(){var t;return function(i){return void 0===t&&(t=new THREE.Vector3),t.copy(this).projectOnVector(i),this.sub(t)}}(),reflect:function(){var t;return function(i){return void 0===t&&(t=new THREE.Vector3),this.sub(t.copy(i).multiplyScalar(2*this.dot(i)))}}(),angleTo:function(t){var i=this.dot(t)/(this.length()*t.length());return Math.acos(THREE.Math.clamp(i,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var i=this.x-t.x,s=this.y-t.y,n=this.z-t.z;return i*i+s*s+n*n},setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,i){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,i)},setFromMatrixPosition:function(t){return this.x=t.elements[12],this.y=t.elements[13],this.z=t.elements[14],this},setFromMatrixScale:function(t){var i=this.set(t.elements[0],t.elements[1],t.elements[2]).length(),s=this.set(t.elements[4],t.elements[5],t.elements[6]).length(),n=this.set(t.elements[8],t.elements[9],t.elements[10]).length();return this.x=i,this.y=s,this.z=n,this},setFromMatrixColumn:function(t,i){var s=4*t,n=i.elements;return this.x=n[s],this.y=n[s+1],this.z=n[s+2],this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,i){return void 0===i&&(i=0),this.x=t[i],this.y=t[i+1],this.z=t[i+2],this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t},fromAttribute:function(t,i,s){return void 0===s&&(s=0),i=i*t.itemSize+s,this.x=t.array[i],this.y=t.array[i+1],this.z=t.array[i+2],this},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}},THREE.Vector4=function(t,i,s,n){this.x=t||0,this.y=i||0,this.z=s||0,this.w=void 0!==n?n:1},THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(t,i,s,n){return this.x=t,this.y=i,this.z=s,this.w=n,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error("index is out of range: "+t)}},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,i){return void 0!==i?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this.w=t.w+i.w,this},sub:function(t,i){return void 0!==i?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this.w=t.w-i.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var i=this.x,s=this.y,n=this.z,r=this.w,e=t.elements;return this.x=e[0]*i+e[4]*s+e[8]*n+e[12]*r,this.y=e[1]*i+e[5]*s+e[9]*n+e[13]*r,this.z=e[2]*i+e[6]*s+e[10]*n+e[14]*r,this.w=e[3]*i+e[7]*s+e[11]*n+e[15]*r,this},divideScalar:function(t){if(0!==t){var i=1/t;this.x*=i,this.y*=i,this.z*=i,this.w*=i}else this.x=0,this.y=0,this.z=0,this.w=1;return this},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var i=Math.sqrt(1-t.w*t.w);return 1e-4>i?(this.x=1,this.y=0,this.z=0):(this.x=t.x/i,this.y=t.y/i,this.z=t.z/i),this},setAxisAngleFromRotationMatrix:function(t){var i,s,n,r,e=.01,h=.1,o=t.elements,a=o[0],u=o[4],c=o[8],l=o[1],y=o[5],x=o[9],f=o[2],m=o[6],d=o[10];if(Math.abs(u-l)<e&&Math.abs(c-f)<e&&Math.abs(x-m)<e){if(Math.abs(u+l)<h&&Math.abs(c+f)<h&&Math.abs(x+m)<h&&Math.abs(a+y+d-3)<h)return this.set(1,0,0,0),this;i=Math.PI;var z=(a+1)/2,_=(y+1)/2,E=(d+1)/2,M=(u+l)/4,w=(c+f)/4,p=(x+m)/4;return z>_&&z>E?e>z?(s=0,n=.707106781,r=.707106781):(s=Math.sqrt(z),n=M/s,r=w/s):_>E?e>_?(s=.707106781,n=0,r=.707106781):(n=Math.sqrt(_),s=M/n,r=p/n):e>E?(s=.707106781,n=.707106781,r=0):(r=Math.sqrt(E),s=w/r,n=p/r),this.set(s,n,r,i),this}var v=Math.sqrt((m-x)*(m-x)+(c-f)*(c-f)+(l-u)*(l-u));return Math.abs(v)<.001&&(v=1),this.x=(m-x)/v,this.y=(c-f)/v,this.z=(l-u)/v,this.w=Math.acos((a+y+d-1)/2),this},min:function(t){return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),this.z>t.z&&(this.z=t.z),this.w>t.w&&(this.w=t.w),this},max:function(t){return this.x<t.x&&(this.x=t.x),this.y<t.y&&(this.y=t.y),this.z<t.z&&(this.z=t.z),this.w<t.w&&(this.w=t.w),this},clamp:function(t,i){return this.x<t.x?this.x=t.x:this.x>i.x&&(this.x=i.x),this.y<t.y?this.y=t.y:this.y>i.y&&(this.y=i.y),this.z<t.z?this.z=t.z:this.z>i.z&&(this.z=i.z),this.w<t.w?this.w=t.w:this.w>i.w&&(this.w=i.w),this},clampScalar:function(){var t,i;return function(s,n){return void 0===t&&(t=new THREE.Vector4,i=new THREE.Vector4),t.set(s,s,s,s),i.set(n,n,n,n),this.clamp(t,i)}}(),floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(t){var i=this.length();return 0!==i&&t!==i&&this.multiplyScalar(t/i),this},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this.w+=(t.w-this.w)*i,this},lerpVectors:function(t,i,s){return this.subVectors(i,t).multiplyScalar(s).add(t),this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,i){return void 0===i&&(i=0),this.x=t[i],this.y=t[i+1],this.z=t[i+2],this.w=t[i+3],this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t[i+3]=this.w,t},fromAttribute:function(t,i,s){return void 0===s&&(s=0),i=i*t.itemSize+s,this.x=t.array[i],this.y=t.array[i+1],this.z=t.array[i+2],this.w=t.array[i+3],this},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}},THREE.Euler=function(t,i,s,n){this._x=t||0,this._y=i||0,this._z=s||0,this._order=n||THREE.Euler.DefaultOrder},THREE.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],THREE.Euler.DefaultOrder="XYZ",THREE.Euler.prototype={constructor:THREE.Euler,_x:0,_y:0,_z:0,_order:THREE.Euler.DefaultOrder,get x(){return this._x},set x(t){this._x=t,this.onChangeCallback()},get y(){return this._y},set y(t){this._y=t,this.onChangeCallback()},get z(){return this._z},set z(t){this._z=t,this.onChangeCallback()},get order(){return this._order},set order(t){this._order=t,this.onChangeCallback()},set:function(t,i,s,n){return this._x=t,this._y=i,this._z=s,this._order=n||this._order,this.onChangeCallback(),this},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,i,s){var n=THREE.Math.clamp,r=t.elements,e=r[0],h=r[4],o=r[8],a=r[1],u=r[5],c=r[9],l=r[2],y=r[6],x=r[10];return i=i||this._order,"XYZ"===i?(this._y=Math.asin(n(o,-1,1)),Math.abs(o)<.99999?(this._x=Math.atan2(-c,x),this._z=Math.atan2(-h,e)):(this._x=Math.atan2(y,u),this._z=0)):"YXZ"===i?(this._x=Math.asin(-n(c,-1,1)),Math.abs(c)<.99999?(this._y=Math.atan2(o,x),this._z=Math.atan2(a,u)):(this._y=Math.atan2(-l,e),this._z=0)):"ZXY"===i?(this._x=Math.asin(n(y,-1,1)),Math.abs(y)<.99999?(this._y=Math.atan2(-l,x),this._z=Math.atan2(-h,u)):(this._y=0,this._z=Math.atan2(a,e))):"ZYX"===i?(this._y=Math.asin(-n(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(y,x),this._z=Math.atan2(a,e)):(this._x=0,this._z=Math.atan2(-h,u))):"YZX"===i?(this._z=Math.asin(n(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-l,e)):(this._x=0,this._y=Math.atan2(o,x))):"XZY"===i?(this._z=Math.asin(-n(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(y,u),this._y=Math.atan2(o,e)):(this._x=Math.atan2(-c,x),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+i),this._order=i,s!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var t;return function(i,s,n){return void 0===t&&(t=new THREE.Matrix4),t.makeRotationFromQuaternion(i),this.setFromRotationMatrix(t,s,n),this}}(),setFromVector3:function(t,i){return this.set(t.x,t.y,t.z,i||this._order)},reorder:function(){var t=new THREE.Quaternion;return function(i){t.setFromEuler(this),this.setFromQuaternion(t,i)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,i){return void 0===t&&(t=[]),void 0===i&&(i=0),t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new THREE.Vector3(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){},clone:function(){return new THREE.Euler(this._x,this._y,this._z,this._order)}},THREE.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]),arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")},THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(t,i,s,n,r,e,h,o,a){var u=this.elements;return u[0]=t,u[3]=i,u[6]=s,u[1]=n,u[4]=r,u[7]=e,u[2]=h,u[5]=o,u[8]=a,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},copy:function(t){var i=t.elements;return this.set(i[0],i[3],i[6],i[1],i[4],i[7],i[2],i[5],i[8]),this},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(t){return console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)},applyToVector3Array:function(){var t;return function(i,s,n){void 0===t&&(t=new THREE.Vector3),void 0===s&&(s=0),void 0===n&&(n=i.length);for(var r=0,e=s;n>r;r+=3,e+=3)t.fromArray(i,e),t.applyMatrix3(this),t.toArray(i,e);return i}}(),applyToBuffer:function(){var t;return function(i,s,n){void 0===t&&(t=new THREE.Vector3),void 0===s&&(s=0),void 0===n&&(n=i.length/i.itemSize);for(var r=0,e=s;n>r;r++,e++)t.x=i.getX(e),t.y=i.getY(e),t.z=i.getZ(e),t.applyMatrix3(this),i.setXYZ(t.x,t.y,t.z);return i}}(),multiplyScalar:function(t){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=t,i[4]*=t,i[7]*=t,i[2]*=t,i[5]*=t,i[8]*=t,this},determinant:function(){var t=this.elements,i=t[0],s=t[1],n=t[2],r=t[3],e=t[4],h=t[5],o=t[6],a=t[7],u=t[8];return i*e*u-i*h*a-s*r*u+s*h*o+n*r*a-n*e*o},getInverse:function(t,i){var s=t.elements,n=this.elements;n[0]=s[10]*s[5]-s[6]*s[9],n[1]=-s[10]*s[1]+s[2]*s[9],n[2]=s[6]*s[1]-s[2]*s[5],n[3]=-s[10]*s[4]+s[6]*s[8],n[4]=s[10]*s[0]-s[2]*s[8],n[5]=-s[6]*s[0]+s[2]*s[4],n[6]=s[9]*s[4]-s[5]*s[8],n[7]=-s[9]*s[0]+s[1]*s[8],n[8]=s[5]*s[0]-s[1]*s[4];var r=s[0]*n[0]+s[1]*n[3]+s[2]*n[6];if(0===r){var e="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(i)throw new Error(e);return console.warn(e),this.identity(),this}return this.multiplyScalar(1/r),this},transpose:function(){var t,i=this.elements;return t=i[1],i[1]=i[3],i[3]=t,t=i[2],i[2]=i[6],i[6]=t,t=i[5],i[5]=i[7],i[7]=t,this},flattenToArrayOffset:function(t,i){var s=this.elements;return t[i]=s[0],t[i+1]=s[1],t[i+2]=s[2],t[i+3]=s[3],t[i+4]=s[4],t[i+5]=s[5],t[i+6]=s[6],t[i+7]=s[7],t[i+8]=s[8],t},getNormalMatrix:function(t){return this.getInverse(t).transpose(),this},transposeIntoArray:function(t){var i=this.elements;return t[0]=i[0],t[1]=i[3],t[2]=i[6],t[3]=i[1],t[4]=i[4],t[5]=i[7],t[6]=i[2],t[7]=i[5],t[8]=i[8],this},fromArray:function(t){return this.elements.set(t),this},toArray:function(){var t=this.elements;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]]},clone:function(){return(new THREE.Matrix3).fromArray(this.elements)}},THREE.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")},THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(t,i,s,n,r,e,h,o,a,u,c,l,y,x,f,m){var d=this.elements;return d[0]=t,d[4]=i,d[8]=s,d[12]=n,d[1]=r,d[5]=e,d[9]=h,d[13]=o,d[2]=a,d[6]=u,d[10]=c,d[14]=l,d[3]=y,d[7]=x,d[11]=f,d[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(t){return this.elements.set(t.elements),this},extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},copyPosition:function(t){var i=this.elements,s=t.elements;return i[12]=s[12],i[13]=s[13],i[14]=s[14],this},extractBasis:function(t,i,s){var n=this.elements;return t.set(n[0],n[1],n[2]),i.set(n[4],n[5],n[6]),s.set(n[8],n[9],n[10]),this},makeBasis:function(t,i,s){return this.set(t.x,i.x,s.x,0,t.y,i.y,s.y,0,t.z,i.z,s.z,0,0,0,0,1),this},extractRotation:function(){var t;return function(i){void 0===t&&(t=new THREE.Vector3);var s=this.elements,n=i.elements,r=1/t.set(n[0],n[1],n[2]).length(),e=1/t.set(n[4],n[5],n[6]).length(),h=1/t.set(n[8],n[9],n[10]).length();return s[0]=n[0]*r,s[1]=n[1]*r,s[2]=n[2]*r,s[4]=n[4]*e,s[5]=n[5]*e,s[6]=n[6]*e,s[8]=n[8]*h,s[9]=n[9]*h,s[10]=n[10]*h,this}}(),makeRotationFromEuler:function(t){t instanceof THREE.Euler==!1&&console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var i=this.elements,s=t.x,n=t.y,r=t.z,e=Math.cos(s),h=Math.sin(s),o=Math.cos(n),a=Math.sin(n),u=Math.cos(r),c=Math.sin(r);if("XYZ"===t.order){var l=e*u,y=e*c,x=h*u,f=h*c;i[0]=o*u,i[4]=-o*c,i[8]=a,i[1]=y+x*a,i[5]=l-f*a,i[9]=-h*o,i[2]=f-l*a,i[6]=x+y*a,i[10]=e*o}else if("YXZ"===t.order){var m=o*u,d=o*c,z=a*u,_=a*c;i[0]=m+_*h,i[4]=z*h-d,i[8]=e*a,i[1]=e*c,i[5]=e*u,i[9]=-h,i[2]=d*h-z,i[6]=_+m*h,i[10]=e*o}else if("ZXY"===t.order){var m=o*u,d=o*c,z=a*u,_=a*c;i[0]=m-_*h,i[4]=-e*c,i[8]=z+d*h,i[1]=d+z*h,i[5]=e*u,i[9]=_-m*h,i[2]=-e*a,i[6]=h,i[10]=e*o}else if("ZYX"===t.order){var l=e*u,y=e*c,x=h*u,f=h*c;i[0]=o*u,i[4]=x*a-y,i[8]=l*a+f,i[1]=o*c,i[5]=f*a+l,i[9]=y*a-x,i[2]=-a,i[6]=h*o,i[10]=e*o}else if("YZX"===t.order){var E=e*o,M=e*a,w=h*o,p=h*a;i[0]=o*u,i[4]=p-E*c,i[8]=w*c+M,i[1]=c,i[5]=e*u,i[9]=-h*u,i[2]=-a*u,i[6]=M*c+w,i[10]=E-p*c}else if("XZY"===t.order){var E=e*o,M=e*a,w=h*o,p=h*a;i[0]=o*u,i[4]=-c,i[8]=a*u,i[1]=E*c+p,i[5]=e*u,i[9]=M*c-w,i[2]=w*c-M,i[6]=h*u,i[10]=p*c+E}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},makeRotationFromQuaternion:function(t){var i=this.elements,s=t.x,n=t.y,r=t.z,e=t.w,h=s+s,o=n+n,a=r+r,u=s*h,c=s*o,l=s*a,y=n*o,x=n*a,f=r*a,m=e*h,d=e*o,z=e*a;return i[0]=1-(y+f),i[4]=c-z,i[8]=l+d,i[1]=c+z,i[5]=1-(u+f),i[9]=x-m,i[2]=l-d,i[6]=x+m,i[10]=1-(u+y),i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},lookAt:function(){var t,i,s;return function(n,r,e){void 0===t&&(t=new THREE.Vector3),void 0===i&&(i=new THREE.Vector3),void 0===s&&(s=new THREE.Vector3);var h=this.elements;return s.subVectors(n,r).normalize(),0===s.length()&&(s.z=1),t.crossVectors(e,s).normalize(),0===t.length()&&(s.x+=1e-4,t.crossVectors(e,s).normalize()),i.crossVectors(s,t),h[0]=t.x,h[4]=i.x,h[8]=s.x,h[1]=t.y,h[5]=i.y,h[9]=s.y,h[2]=t.z,h[6]=i.z,h[10]=s.z,this
}}(),multiply:function(t,i){return void 0!==i?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,i)):this.multiplyMatrices(this,t)},multiplyMatrices:function(t,i){var s=t.elements,n=i.elements,r=this.elements,e=s[0],h=s[4],o=s[8],a=s[12],u=s[1],c=s[5],l=s[9],y=s[13],x=s[2],f=s[6],m=s[10],d=s[14],z=s[3],_=s[7],E=s[11],M=s[15],w=n[0],p=n[4],v=n[8],b=n[12],g=n[1],R=n[5],T=n[9],V=n[13],H=n[2],C=n[6],A=n[10],F=n[14],k=n[3],S=n[7],j=n[11],Z=n[15];return r[0]=e*w+h*g+o*H+a*k,r[4]=e*p+h*R+o*C+a*S,r[8]=e*v+h*T+o*A+a*j,r[12]=e*b+h*V+o*F+a*Z,r[1]=u*w+c*g+l*H+y*k,r[5]=u*p+c*R+l*C+y*S,r[9]=u*v+c*T+l*A+y*j,r[13]=u*b+c*V+l*F+y*Z,r[2]=x*w+f*g+m*H+d*k,r[6]=x*p+f*R+m*C+d*S,r[10]=x*v+f*T+m*A+d*j,r[14]=x*b+f*V+m*F+d*Z,r[3]=z*w+_*g+E*H+M*k,r[7]=z*p+_*R+E*C+M*S,r[11]=z*v+_*T+E*A+M*j,r[15]=z*b+_*V+E*F+M*Z,this},multiplyToArray:function(t,i,s){var n=this.elements;return this.multiplyMatrices(t,i),s[0]=n[0],s[1]=n[1],s[2]=n[2],s[3]=n[3],s[4]=n[4],s[5]=n[5],s[6]=n[6],s[7]=n[7],s[8]=n[8],s[9]=n[9],s[10]=n[10],s[11]=n[11],s[12]=n[12],s[13]=n[13],s[14]=n[14],s[15]=n[15],this},multiplyScalar:function(t){var i=this.elements;return i[0]*=t,i[4]*=t,i[8]*=t,i[12]*=t,i[1]*=t,i[5]*=t,i[9]*=t,i[13]*=t,i[2]*=t,i[6]*=t,i[10]*=t,i[14]*=t,i[3]*=t,i[7]*=t,i[11]*=t,i[15]*=t,this},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."),t.applyProjection(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(t){return console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead."),this.applyToVector3Array(t)},applyToVector3Array:function(){var t;return function(i,s,n){void 0===t&&(t=new THREE.Vector3),void 0===s&&(s=0),void 0===n&&(n=i.length);for(var r=0,e=s;n>r;r+=3,e+=3)t.fromArray(i,e),t.applyMatrix4(this),t.toArray(i,e);return i}}(),applyToBuffer:function(){var t;return function(i,s,n){void 0===t&&(t=new THREE.Vector3),void 0===s&&(s=0),void 0===n&&(n=i.length/i.itemSize);for(var r=0,e=s;n>r;r++,e++)t.x=i.getX(e),t.y=i.getY(e),t.z=i.getZ(e),t.applyMatrix4(this),i.setXYZ(t.x,t.y,t.z);return i}}(),rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},determinant:function(){var t=this.elements,i=t[0],s=t[4],n=t[8],r=t[12],e=t[1],h=t[5],o=t[9],a=t[13],u=t[2],c=t[6],l=t[10],y=t[14],x=t[3],f=t[7],m=t[11],d=t[15];return x*(+r*o*c-n*a*c-r*h*l+s*a*l+n*h*y-s*o*y)+f*(+i*o*y-i*a*l+r*e*l-n*e*y+n*a*u-r*o*u)+m*(+i*a*c-i*h*y-r*e*c+s*e*y+r*h*u-s*a*u)+d*(-n*h*u-i*o*c+i*h*l+n*e*c-s*e*l+s*o*u)},transpose:function(){var t,i=this.elements;return t=i[1],i[1]=i[4],i[4]=t,t=i[2],i[2]=i[8],i[8]=t,t=i[6],i[6]=i[9],i[9]=t,t=i[3],i[3]=i[12],i[12]=t,t=i[7],i[7]=i[13],i[13]=t,t=i[11],i[11]=i[14],i[14]=t,this},flattenToArrayOffset:function(t,i){var s=this.elements;return t[i]=s[0],t[i+1]=s[1],t[i+2]=s[2],t[i+3]=s[3],t[i+4]=s[4],t[i+5]=s[5],t[i+6]=s[6],t[i+7]=s[7],t[i+8]=s[8],t[i+9]=s[9],t[i+10]=s[10],t[i+11]=s[11],t[i+12]=s[12],t[i+13]=s[13],t[i+14]=s[14],t[i+15]=s[15],t},getPosition:function(){var t;return function(){void 0===t&&(t=new THREE.Vector3),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var i=this.elements;return t.set(i[12],i[13],i[14])}}(),setPosition:function(t){var i=this.elements;return i[12]=t.x,i[13]=t.y,i[14]=t.z,this},getInverse:function(t,i){var s=this.elements,n=t.elements,r=n[0],e=n[4],h=n[8],o=n[12],a=n[1],u=n[5],c=n[9],l=n[13],y=n[2],x=n[6],f=n[10],m=n[14],d=n[3],z=n[7],_=n[11],E=n[15];s[0]=c*m*z-l*f*z+l*x*_-u*m*_-c*x*E+u*f*E,s[4]=o*f*z-h*m*z-o*x*_+e*m*_+h*x*E-e*f*E,s[8]=h*l*z-o*c*z+o*u*_-e*l*_-h*u*E+e*c*E,s[12]=o*c*x-h*l*x-o*u*f+e*l*f+h*u*m-e*c*m,s[1]=l*f*d-c*m*d-l*y*_+a*m*_+c*y*E-a*f*E,s[5]=h*m*d-o*f*d+o*y*_-r*m*_-h*y*E+r*f*E,s[9]=o*c*d-h*l*d-o*a*_+r*l*_+h*a*E-r*c*E,s[13]=h*l*y-o*c*y+o*a*f-r*l*f-h*a*m+r*c*m,s[2]=u*m*d-l*x*d+l*y*z-a*m*z-u*y*E+a*x*E,s[6]=o*x*d-e*m*d-o*y*z+r*m*z+e*y*E-r*x*E,s[10]=e*l*d-o*u*d+o*a*z-r*l*z-e*a*E+r*u*E,s[14]=o*u*y-e*l*y-o*a*x+r*l*x+e*a*m-r*u*m,s[3]=c*x*d-u*f*d-c*y*z+a*f*z+u*y*_-a*x*_,s[7]=e*f*d-h*x*d+h*y*z-r*f*z-e*y*_+r*x*_,s[11]=h*u*d-e*c*d-h*a*z+r*c*z+e*a*_-r*u*_,s[15]=e*c*y-h*u*y+h*a*x-r*c*x-e*a*f+r*u*f;var M=r*s[0]+a*s[4]+y*s[8]+d*s[12];if(0===M){var w="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";if(i)throw new Error(w);return console.warn(w),this.identity(),this}return this.multiplyScalar(1/M),this},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},scale:function(t){var i=this.elements,s=t.x,n=t.y,r=t.z;return i[0]*=s,i[4]*=n,i[8]*=r,i[1]*=s,i[5]*=n,i[9]*=r,i[2]*=s,i[6]*=n,i[10]*=r,i[3]*=s,i[7]*=n,i[11]*=r,this},getMaxScaleOnAxis:function(){var t=this.elements,i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],s=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(i,Math.max(s,n)))},makeTranslation:function(t,i,s){return this.set(1,0,0,t,0,1,0,i,0,0,1,s,0,0,0,1),this},makeRotationX:function(t){var i=Math.cos(t),s=Math.sin(t);return this.set(1,0,0,0,0,i,-s,0,0,s,i,0,0,0,0,1),this},makeRotationY:function(t){var i=Math.cos(t),s=Math.sin(t);return this.set(i,0,s,0,0,1,0,0,-s,0,i,0,0,0,0,1),this},makeRotationZ:function(t){var i=Math.cos(t),s=Math.sin(t);return this.set(i,-s,0,0,s,i,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,i){var s=Math.cos(i),n=Math.sin(i),r=1-s,e=t.x,h=t.y,o=t.z,a=r*e,u=r*h;return this.set(a*e+s,a*h-n*o,a*o+n*h,0,a*h+n*o,u*h+s,u*o-n*e,0,a*o-n*h,u*o+n*e,r*o*o+s,0,0,0,0,1),this},makeScale:function(t,i,s){return this.set(t,0,0,0,0,i,0,0,0,0,s,0,0,0,0,1),this},compose:function(t,i,s){return this.makeRotationFromQuaternion(i),this.scale(s),this.setPosition(t),this},decompose:function(){var t,i;return function(s,n,r){void 0===t&&(t=new THREE.Vector3),void 0===i&&(i=new THREE.Matrix4);var e=this.elements,h=t.set(e[0],e[1],e[2]).length(),o=t.set(e[4],e[5],e[6]).length(),a=t.set(e[8],e[9],e[10]).length(),u=this.determinant();0>u&&(h=-h),s.x=e[12],s.y=e[13],s.z=e[14],i.elements.set(this.elements);var c=1/h,l=1/o,y=1/a;return i.elements[0]*=c,i.elements[1]*=c,i.elements[2]*=c,i.elements[4]*=l,i.elements[5]*=l,i.elements[6]*=l,i.elements[8]*=y,i.elements[9]*=y,i.elements[10]*=y,n.setFromRotationMatrix(i),r.x=h,r.y=o,r.z=a,this}}(),makeFrustum:function(t,i,s,n,r,e){var h=this.elements,o=2*r/(i-t),a=2*r/(n-s),u=(i+t)/(i-t),c=(n+s)/(n-s),l=-(e+r)/(e-r),y=-2*e*r/(e-r);return h[0]=o,h[4]=0,h[8]=u,h[12]=0,h[1]=0,h[5]=a,h[9]=c,h[13]=0,h[2]=0,h[6]=0,h[10]=l,h[14]=y,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this},makePerspective:function(t,i,s,n){var r=s*Math.tan(THREE.Math.degToRad(.5*t)),e=-r,h=e*i,o=r*i;return this.makeFrustum(h,o,e,r,s,n)},makeOrthographic:function(t,i,s,n,r,e){var h=this.elements,o=i-t,a=s-n,u=e-r,c=(i+t)/o,l=(s+n)/a,y=(e+r)/u;return h[0]=2/o,h[4]=0,h[8]=0,h[12]=-c,h[1]=0,h[5]=2/a,h[9]=0,h[13]=-l,h[2]=0,h[6]=0,h[10]=-2/u,h[14]=-y,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this},fromArray:function(t){return this.elements.set(t),this},toArray:function(){var t=this.elements;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]},clone:function(){return(new THREE.Matrix4).fromArray(this.elements)}},THREE.Math={generateUUID:function(){var t,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),s=new Array(36),n=0;return function(){for(var r=0;36>r;r++)8===r||13===r||18===r||23===r?s[r]="-":14===r?s[r]="4":(2>=n&&(n=33554432+16777216*Math.random()|0),t=15&n,n>>=4,s[r]=i[19===r?3&t|8:t]);return s.join("")}}(),clamp:function(t,i,s){return i>t?i:t>s?s:t},clampBottom:function(t,i){return i>t?i:t},mapLinear:function(t,i,s,n,r){return n+(t-i)*(r-n)/(s-i)},smoothstep:function(t,i,s){return i>=t?0:t>=s?1:(t=(t-i)/(s-i),t*t*(3-2*t))},smootherstep:function(t,i,s){return i>=t?0:t>=s?1:(t=(t-i)/(s-i),t*t*t*(t*(6*t-15)+10))},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(t,i){return Math.floor(this.randFloat(t,i))},randFloat:function(t,i){return t+Math.random()*(i-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(){var t=Math.PI/180;return function(i){return i*t}}(),radToDeg:function(){var t=180/Math.PI;return function(i){return i*t}}(),isPowerOfTwo:function(t){return 0===(t&t-1)&&0!==t},nextPowerOfTwo:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t++,t}};
!function(e){"use strict";e(function(e,t,n){function o(e){var t=2/(e.leftTan+e.rightTan),n=(e.leftTan-e.rightTan)*t*.5,o=2/(e.upTan+e.downTan),r=(e.upTan-e.downTan)*o*.5;return{scale:[t,o],offset:[n,r]}}function r(e,t,n,r){t=void 0===t?!0:t,n=void 0===n?.01:n,r=void 0===r?1e4:r;var a=t?-1:1,i=new THREE.Matrix4,f=i.elements,s=o(e);return f[0]=s.scale[0],f[1]=0,f[2]=s.offset[0]*a,f[3]=0,f[4]=0,f[5]=s.scale[1],f[6]=-s.offset[1]*a,f[7]=0,f[8]=0,f[9]=0,f[10]=r/(n-r)*-a,f[11]=r*n/(n-r),f[12]=0,f[13]=0,f[14]=a,f[15]=0,i.transpose(),i}function a(e,t,n,o){var a=Math.PI/180,i={upTan:Math.tan(e.upDegrees*a),downTan:Math.tan(e.downDegrees*a),leftTan:Math.tan(e.leftDegrees*a),rightTan:Math.tan(e.rightDegrees*a)};return r(i,t,n,o)}n.exports={fovToProjection:a}})}("function"==typeof define&&define.amd?define:function(e,t){"use strict";return"object"==typeof module?function(e){e(require,exports,module)}:function(n){var o={exports:{}};n(function(e){return t[e]},o.exports,o),t[e]=o.exports}}("VRPerspective",this));
!function(e){"use strict";e(function(e,t,n){function i(e){function t(t){for(var n,n=0;n<t.length;++n)if(t[n]instanceof HMDVRDevice)H.headset=t[n];else if(t[n]instanceof PositionSensorVRDevice&&(H.position=t[n]),H.headset&&H.position)break;e()}navigator.getVRDevices&&navigator.getVRDevices().then?navigator.getVRDevices().then(t):e()}function s(){T.call(x,{vrDisplay:H.headset})}function a(){p=H.headset?H.headset.getEyeParameters("left").recommendedFieldOfView:{upDegrees:45,rightDegrees:45,downDegrees:45,leftDegrees:45};var e=d(THREE.Math.degToRad(p.upDegrees),E.offsetWidth/E.offsetHeight,1,1e4);e=e.clone().scale(new THREE.Vector3(E.offsetWidth,E.offsetHeight,1)),R=u(e),E.style.transform=R,E.style.webkitTransform=R}function o(){var e,t=x.children,n=t.length;for(E=document.createElement("div"),E.classList.add("viewport"),h=document.createElement("div"),h.classList.add("vr"),h.classList.add("camera"),v=document.createElement("div"),v.classList.add("vr"),v.classList.add("world"),e=0;n>e;++e)v.appendChild(t[0]);x.appendChild(E),E.appendChild(h),h.appendChild(v),T=x.mozRequestFullScreen||x.webkitRequestFullscreen}function r(){var e;e=M?"translate3d(-50%, -50%, 0px)":R,l(),E.style.transform=e,E.style.webkitTransform=e,window.requestAnimationFrame(r)}function l(){var e,t,n,i;H.position&&(i=H.position.getState(),e=i.orientation,n=i.position,e&&(t=new THREE.Quaternion(e.x,-e.y,e.z,e.w),w=(new THREE.Matrix4).makeRotationFromQuaternion(t)),n&&(V=(new THREE.Matrix4).makeTranslation(n.x,n.y,n.z))),Y(h,{rotation:w,translation:V})}function c(){function e(){return document.mozFullScreenElement||document.webkitFullScreenElement?(M=!0,void E.classList.add("fullscreen")):(E.classList.remove("fullscreen"),void(M=!1))}document.addEventListener("webkitfullscreenchange",e),document.addEventListener("mozfullscreenchange",e),document.addEventListener("fullscreenchange",e)}function d(e,t,n,i){var s=new THREE.Matrix4,a=Math.tan(.5*e)*n;return s.elements[0]=2*n/(a*t- -a*t),s.elements[1]=0,s.elements[2]=0,s.elements[3]=0,s.elements[4]=0,s.elements[5]=2*n/(2*a),s.elements[6]=0,s.elements[7]=0,s.elements[8]=0,s.elements[9]=0,s.elements[10]=-(i+n)/(i-n),s.elements[11]=-1,s.elements[12]=0,s.elements[13]=0,s.elements[14]=-(2*i*n)/(i-n),s.elements[15]=0,s.transpose()}function u(e){var t=e.elements;return"matrix3d("+m(t[0])+","+m(t[1])+","+m(t[2])+","+m(t[3])+","+m(t[4])+","+m(t[5])+","+m(t[6])+","+m(t[7])+","+m(t[8])+","+m(t[9])+","+m(t[10])+","+m(t[11])+","+m(t[12])+","+m(t[13])+","+m(t[14])+","+m(t[15])+")"}function m(e){return Math.abs(e)<1e-6?0:e}function f(){x.addEventListener("mousedown",function(e){z=!0,x.classList.add("selection-disabled"),x.classList.add("grabbing"),C=e.clientX,X=e.clientY},!0),x.addEventListener("mouseup",function(){z=!1,x.classList.remove("selection-disabled"),x.classList.remove("grabbing")},!0),x.addEventListener("mousemove",function(e){if(z){var t=.2*(e.clientX-C),n=.2*(e.clientY-X);b+=t,k-=n,k=Math.max(-90,Math.min(90,k)),C=e.clientX,X=e.clientY,V=(new THREE.Matrix4).makeTranslation(L,y,D),F=new THREE.Euler(THREE.Math.degToRad(k),THREE.Math.degToRad(b),THREE.Math.degToRad(S),"XYZ"),w=(new THREE.Matrix4).makeRotationFromEuler(F)}},!0),document.documentElement.addEventListener("keydown",function(e){32==(e.keycode||e.which)&&e.preventDefault()},!1)}var E,v,h,R,p,w,g,T,H={},x=document.querySelector("#scene"),M=!1,L=0,y=0,D=0,b=0,k=0,S=0,V=new THREE.Matrix4,F=THREE.Euler(0,0,0,"YXZ"),q=parseInt((new Date).getTime());i(function(){var e;o(),a(),f(),c(),e=parseInt((new Date).getTime()),console.log("GET VR Devices time :"+(e-q)),g=window.requestAnimationFrame(r)});var z,C,X,Y=(Math.PI/2,function(e,t){var n=t.translation.clone()||new THREE.Matrix4,i=t.rotation||new THREE.Matrix4,s=u(n.multiply(i));e.style.transform="translate3d(-50%, -50%, 0) "+s,e.style.webkitTransform="translate3d(-50%, -50%, 0) "+s});n.exports={zeroSensor:function(){b=0,k=0,w=new THREE.Matrix4,V=new THREE.Matrix4,H.position&&H.position.resetSensor()},enterVR:s}})}("function"==typeof define&&define.amd?define:function(e,t){"use strict";return"object"==typeof module?function(e){e(require,exports,module)}:function(n){var i={exports:{}};n(function(e){return t[e]},i.exports,i),t[e]=i.exports}}("VRCSS",this));